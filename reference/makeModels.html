<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Build model matrices for differential expression — makeModels • derfinder</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Build model matrices for differential expression — makeModels" />
<meta property="og:description" content="Builds the model matrices for testing for differential expression by
comparing a model with a grouping factor versus one without it. It adjusts
for the confounders specified and the median coverage of each sample. The
resulting models can be used in calculateStats." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">derfinder</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.21.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/derfinder-quickstart.html">derfinder quick start guide</a>
    </li>
    <li>
      <a href="../articles/derfinder-users-guide.html">derfinder users guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lcolladotor/derfinder/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build model matrices for differential expression</h1>
    <small class="dont-index">Source: <a href='https://github.com/lcolladotor/derfinder/blob/master/R/makeModels.R'><code>R/makeModels.R</code></a></small>
    <div class="hidden name"><code>makeModels.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Builds the model matrices for testing for differential expression by
comparing a model with a grouping factor versus one without it. It adjusts
for the confounders specified and the median coverage of each sample. The
resulting models can be used in <a href='calculateStats.html'>calculateStats</a>.</p>
    </div>

    <pre class="usage"><span class='fu'>makeModels</span>(<span class='no'>sampleDepths</span>, <span class='no'>testvars</span>, <span class='kw'>adjustvars</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>testIntercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sampleDepths</th>
      <td><p>Per sample library size adjustments calculated with
<a href='sampleDepth.html'>sampleDepth</a>.</p></td>
    </tr>
    <tr>
      <th>testvars</th>
      <td><p>A vector or matrix specifying the variables to test. For
example, a factor with the group memberships when testing for differences
across groups. It's length should match the number of columns used from
<code>coverageInfo$coverage</code>.</p></td>
    </tr>
    <tr>
      <th>adjustvars</th>
      <td><p>Optional matrix of adjustment variables (e.g. measured
confounders, output from SVA, etc.) to use in fitting linear models to each
nucleotide. These variables have to be specified by sample and the number of
rows must match the number of columns used. It will also work if it is a
vector of the correct length.</p></td>
    </tr>
    <tr>
      <th>testIntercept</th>
      <td><p>If <code>TRUE</code> then <code>testvars</code> is ignored and mod0
will contain the column medians and any adjusting variables specified, but
no intercept.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with two components.</p><dl>
<dt>mod </dt><dd><p>The alternative model matrix.</p></dd>
<dt>mod0 </dt><dd><p>The null model matrix.</p></dd>

</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='sampleDepth.html'>sampleDepth</a>, <a href='calculateStats.html'>calculateStats</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Collapse the coverage information</span>
<span class='no'>collapsedFull</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='collapseFullCoverage.html'>collapseFullCoverage</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>genomeData</span>$<span class='no'>coverage</span>),
    <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='output co'>#&gt; <span class='message'>2020-04-27 15:01:03 collapseFullCoverage: Sorting fullCov</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 15:01:03 collapseFullCoverage: Collapsing chromosomes information by sample</span></div><div class='input'>
<span class='co'>## Calculate library size adjustments</span>
<span class='no'>sampleDepths</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sampleDepth.html'>sampleDepth</a></span>(<span class='no'>collapsedFull</span>,
    <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>), <span class='kw'>nonzero</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='output co'>#&gt; <span class='message'>2020-04-27 15:01:03 sampleDepth: Calculating sample quantiles</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 15:01:03 sampleDepth: Calculating sample adjustments</span></div><div class='input'>
<span class='co'>## Build the models</span>
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='no'>genomeInfo</span>$<span class='no'>pop</span>
<span class='no'>adjustvars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>genomeInfo</span>$<span class='no'>gender</span>)
<span class='no'>models</span> <span class='kw'>&lt;-</span> <span class='fu'>makeModels</span>(<span class='no'>sampleDepths</span>, <span class='kw'>testvars</span> <span class='kw'>=</span> <span class='no'>group</span>, <span class='kw'>adjustvars</span> <span class='kw'>=</span> <span class='no'>adjustvars</span>)
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>models</span>)</div><div class='output co'>#&gt; [1] "mod"  "mod0"</div><div class='input'><span class='no'>models</span></div><div class='output co'>#&gt; $mod
#&gt;    (Intercept) testvarsYRI sampleDepths adjustVar1male
#&gt; 1            1           0     8.366322              0
#&gt; 2            1           0     7.954196              0
#&gt; 3            1           0     9.379378              1
#&gt; 4            1           0     8.596190              0
#&gt; 5            1           0     8.523562              0
#&gt; 6            1           0     8.179909              0
#&gt; 7            1           0     6.129283              1
#&gt; 8            1           0     8.233620              0
#&gt; 9            1           0     7.266787              0
#&gt; 10           1           0     8.400879              0
#&gt; 11           1           0     8.044394              0
#&gt; 12           1           0     6.727920              1
#&gt; 13           1           0     7.366322              0
#&gt; 14           1           0     9.134426              0
#&gt; 15           1           0     8.044394              0
#&gt; 16           1           0     8.262095              0
#&gt; 17           1           0     8.991522              0
#&gt; 18           1           0     7.000000              0
#&gt; 19           1           0     6.727920              1
#&gt; 20           1           0     7.285402              0
#&gt; 21           1           0     9.214319              1
#&gt; 22           1           1     6.066089              0
#&gt; 23           1           1     6.285402              0
#&gt; 24           1           1     5.000000              0
#&gt; 25           1           1     5.000000              0
#&gt; 26           1           1     5.000000              0
#&gt; 27           1           1     6.285402              0
#&gt; 28           1           1     5.000000              0
#&gt; 29           1           1     5.000000              0
#&gt; 30           1           1     5.000000              0
#&gt; 31           1           1     5.000000              0
#&gt; attr(,"assign")
#&gt; [1] 0 1 2 3
#&gt; attr(,"contrasts")
#&gt; attr(,"contrasts")$testvars
#&gt; [1] "contr.treatment"
#&gt; 
#&gt; attr(,"contrasts")$adjustVar1
#&gt; [1] "contr.treatment"
#&gt; 
#&gt; 
#&gt; $mod0
#&gt;    (Intercept) sampleDepths adjustVar1male
#&gt; 1            1     8.366322              0
#&gt; 2            1     7.954196              0
#&gt; 3            1     9.379378              1
#&gt; 4            1     8.596190              0
#&gt; 5            1     8.523562              0
#&gt; 6            1     8.179909              0
#&gt; 7            1     6.129283              1
#&gt; 8            1     8.233620              0
#&gt; 9            1     7.266787              0
#&gt; 10           1     8.400879              0
#&gt; 11           1     8.044394              0
#&gt; 12           1     6.727920              1
#&gt; 13           1     7.366322              0
#&gt; 14           1     9.134426              0
#&gt; 15           1     8.044394              0
#&gt; 16           1     8.262095              0
#&gt; 17           1     8.991522              0
#&gt; 18           1     7.000000              0
#&gt; 19           1     6.727920              1
#&gt; 20           1     7.285402              0
#&gt; 21           1     9.214319              1
#&gt; 22           1     6.066089              0
#&gt; 23           1     6.285402              0
#&gt; 24           1     5.000000              0
#&gt; 25           1     5.000000              0
#&gt; 26           1     5.000000              0
#&gt; 27           1     6.285402              0
#&gt; 28           1     5.000000              0
#&gt; 29           1     5.000000              0
#&gt; 30           1     5.000000              0
#&gt; 31           1     5.000000              0
#&gt; attr(,"assign")
#&gt; [1] 0 1 2
#&gt; attr(,"contrasts")
#&gt; attr(,"contrasts")$adjustVar1
#&gt; [1] "contr.treatment"
#&gt; 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Leonardo Collado-Torres, Andrew E. Jaffe, Jeffrey T. Leek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


