<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Collapse full coverage information for efficient quantile computations — collapseFullCoverage • derfinder</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Collapse full coverage information for efficient quantile computations — collapseFullCoverage" />
<meta property="og:description" content="For a given data set this function collapses the full coverage information
for each sample from all the chromosomes. The resulting information per
sample is the number of bases with coverage 0, 1, etc. It is similar to
using table() on a regular vector. This information is then used by
sampleDepth for calculating the sample depth adjustments. The data
set can loaded to R using (see fullCoverage) and optionally filtered
using filterData." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">derfinder</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.21.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/derfinder-quickstart.html">derfinder quick start guide</a>
    </li>
    <li>
      <a href="../articles/derfinder-users-guide.html">derfinder users guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lcolladotor/derfinder/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Collapse full coverage information for efficient quantile computations</h1>
    <small class="dont-index">Source: <a href='https://github.com/lcolladotor/derfinder/blob/master/R/collapseFullCoverage.R'><code>R/collapseFullCoverage.R</code></a></small>
    <div class="hidden name"><code>collapseFullCoverage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For a given data set this function collapses the full coverage information
for each sample from all the chromosomes. The resulting information per
sample is the number of bases with coverage 0, 1, etc. It is similar to
using table() on a regular vector. This information is then used by
<a href='sampleDepth.html'>sampleDepth</a> for calculating the sample depth adjustments. The data
set can loaded to R using (see <a href='fullCoverage.html'>fullCoverage</a>) and optionally filtered
using <a href='filterData.html'>filterData</a>.</p>
    </div>

    <pre class="usage"><span class='fu'>collapseFullCoverage</span>(<span class='no'>fullCov</span>, <span class='kw'>colsubset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>save</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fullCov</th>
      <td><p>A list where each element is the result from
<a href='loadCoverage.html'>loadCoverage</a> used with <code>cutoff=NULL</code>. Can be
generated using <a href='fullCoverage.html'>fullCoverage</a>.</p></td>
    </tr>
    <tr>
      <th>colsubset</th>
      <td><p>Which columns of <code>coverageInfo$coverage</code> to use.</p></td>
    </tr>
    <tr>
      <th>save</th>
      <td><p>If <code>TRUE</code>, the result is saved as 'collapsedFull.Rdata'.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to other methods and/or advanced arguments.
Advanced arguments:</p><dl'>
<dt>verbose </dt><dd><p>If <code>TRUE</code> basic status updates will be printed along
the way. Default: <code>FALSE</code>.</p></dd>

</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with one element per sample. Then per sample, a list with two vector
elements: <code>values</code> and <code>weights</code>. The first one is the coverage
value and the second one is the number of bases with that value.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='fullCoverage.html'>fullCoverage</a>, <a href='sampleDepth.html'>sampleDepth</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Collapse the coverage information for the filtered data</span>
<span class='no'>collapsedFull</span> <span class='kw'>&lt;-</span> <span class='fu'>collapseFullCoverage</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>genomeData</span>),
    <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='output co'>#&gt; <span class='message'>2020-04-21 03:14:51 collapseFullCoverage: Sorting fullCov</span></div><div class='output co'>#&gt; <span class='message'>2020-04-21 03:14:51 collapseFullCoverage: Collapsing chromosomes information by sample</span></div><div class='input'><span class='no'>collapsedFull</span></div><div class='output co'>#&gt; $ERR009101
#&gt; $ERR009101$values
#&gt; [1] 0 1 2
#&gt; 
#&gt; $ERR009101$weights
#&gt; [1] 1105  298   31
#&gt; 
#&gt; 
#&gt; $ERR009102
#&gt; $ERR009102$values
#&gt; [1] 0 1 2
#&gt; 
#&gt; $ERR009102$weights
#&gt; [1] 1216  216    2
#&gt; 
#&gt; 
#&gt; $ERR009105
#&gt; $ERR009105$values
#&gt; [1] 0 1 2 3 4 5 6 7
#&gt; 
#&gt; $ERR009105$weights
#&gt; [1] 726 226 204  67  52  93  38  28
#&gt; 
#&gt; 
#&gt; $ERR009107
#&gt; $ERR009107$values
#&gt; [1] 0 1 2 3 4 5 6
#&gt; 
#&gt; $ERR009107$weights
#&gt; [1] 1156  125  115    2    3   17   16
#&gt; 
#&gt; 
#&gt; $ERR009108
#&gt; $ERR009108$values
#&gt; [1] 0 1 2 3
#&gt; 
#&gt; $ERR009108$weights
#&gt; [1] 1193   74  131   36
#&gt; 
#&gt; 
#&gt; $ERR009112
#&gt; $ERR009112$values
#&gt; [1] 0 1 2
#&gt; 
#&gt; $ERR009112$weights
#&gt; [1] 1161  258   15
#&gt; 
#&gt; 
#&gt; $ERR009115
#&gt; $ERR009115$values
#&gt; [1] 0 1
#&gt; 
#&gt; $ERR009115$weights
#&gt; [1] 1396   38
#&gt; 
#&gt; 
#&gt; $ERR009116
#&gt; $ERR009116$values
#&gt; [1] 0 1 2
#&gt; 
#&gt; $ERR009116$weights
#&gt; [1] 1120  269   45
#&gt; 
#&gt; 
#&gt; $ERR009131
#&gt; $ERR009131$values
#&gt; [1] 0 1 2
#&gt; 
#&gt; $ERR009131$weights
#&gt; [1] 1299  122   13
#&gt; 
#&gt; 
#&gt; $ERR009138
#&gt; $ERR009138$values
#&gt; [1] 0 1 2 3
#&gt; 
#&gt; $ERR009138$weights
#&gt; [1] 1089  306   25   14
#&gt; 
#&gt; 
#&gt; $ERR009144
#&gt; $ERR009144$values
#&gt; [1] 0 1 2
#&gt; 
#&gt; $ERR009144$weights
#&gt; [1] 1097  232  105
#&gt; 
#&gt; 
#&gt; $ERR009145
#&gt; $ERR009145$values
#&gt; [1] 0 1
#&gt; 
#&gt; $ERR009145$weights
#&gt; [1] 1360   74
#&gt; 
#&gt; 
#&gt; $ERR009148
#&gt; $ERR009148$values
#&gt; [1] 0 1 2 3
#&gt; 
#&gt; $ERR009148$weights
#&gt; [1] 1212  133   76   13
#&gt; 
#&gt; 
#&gt; $ERR009151
#&gt; $ERR009151$values
#&gt; [1] 0 1 2 3 4 5
#&gt; 
#&gt; $ERR009151$weights
#&gt; [1] 972 186 172  62  38   4
#&gt; 
#&gt; 
#&gt; $ERR009152
#&gt; $ERR009152$values
#&gt; [1] 0 1 2
#&gt; 
#&gt; $ERR009152$weights
#&gt; [1] 1059  232  143
#&gt; 
#&gt; 
#&gt; $ERR009153
#&gt; $ERR009153$values
#&gt; [1] 0 1 2 3 4
#&gt; 
#&gt; $ERR009153$weights
#&gt; [1] 1104  275   45    9    1
#&gt; 
#&gt; 
#&gt; $ERR009159
#&gt; $ERR009159$values
#&gt; [1] 0 1 2 3 4 5
#&gt; 
#&gt; $ERR009159$weights
#&gt; [1] 975 169 154  63  69   4
#&gt; 
#&gt; 
#&gt; $ERR009161
#&gt; $ERR009161$values
#&gt; [1] 0 1 2 3 4
#&gt; 
#&gt; $ERR009161$weights
#&gt; [1] 1243   96   61   30    4
#&gt; 
#&gt; 
#&gt; $ERR009163
#&gt; $ERR009163$values
#&gt; [1] 0 1
#&gt; 
#&gt; $ERR009163$weights
#&gt; [1] 1360   74
#&gt; 
#&gt; 
#&gt; $ERR009164
#&gt; $ERR009164$values
#&gt; [1] 0 1 2 3
#&gt; 
#&gt; $ERR009164$weights
#&gt; [1] 1336   32   46   20
#&gt; 
#&gt; 
#&gt; $ERR009167
#&gt; $ERR009167$values
#&gt;  [1] 0 1 2 3 4 5 6 7 8 9
#&gt; 
#&gt; $ERR009167$weights
#&gt;  [1] 728 200 181 140  79  17  25  23  24  17
#&gt; 
#&gt; 
#&gt; $SRR031812
#&gt; $SRR031812$values
#&gt; [1] 0 1
#&gt; 
#&gt; $SRR031812$weights
#&gt; [1] 1399   35
#&gt; 
#&gt; 
#&gt; $SRR031835
#&gt; $SRR031835$values
#&gt; [1] 0 1
#&gt; 
#&gt; $SRR031835$weights
#&gt; [1] 1388   46
#&gt; 
#&gt; 
#&gt; $SRR031867
#&gt; $SRR031867$values
#&gt; [1] 0
#&gt; 
#&gt; $SRR031867$weights
#&gt; [1] 1434
#&gt; 
#&gt; 
#&gt; $SRR031868
#&gt; $SRR031868$values
#&gt; [1] 0
#&gt; 
#&gt; $SRR031868$weights
#&gt; [1] 1434
#&gt; 
#&gt; 
#&gt; $SRR031900
#&gt; $SRR031900$values
#&gt; [1] 0
#&gt; 
#&gt; $SRR031900$weights
#&gt; [1] 1434
#&gt; 
#&gt; 
#&gt; $SRR031904
#&gt; $SRR031904$values
#&gt; [1] 0 1
#&gt; 
#&gt; $SRR031904$weights
#&gt; [1] 1388   46
#&gt; 
#&gt; 
#&gt; $SRR031914
#&gt; $SRR031914$values
#&gt; [1] 0
#&gt; 
#&gt; $SRR031914$weights
#&gt; [1] 1434
#&gt; 
#&gt; 
#&gt; $SRR031936
#&gt; $SRR031936$values
#&gt; [1] 0
#&gt; 
#&gt; $SRR031936$weights
#&gt; [1] 1434
#&gt; 
#&gt; 
#&gt; $SRR031958
#&gt; $SRR031958$values
#&gt; [1] 0
#&gt; 
#&gt; $SRR031958$weights
#&gt; [1] 1434
#&gt; 
#&gt; 
#&gt; $SRR031960
#&gt; $SRR031960$values
#&gt; [1] 0
#&gt; 
#&gt; $SRR031960$weights
#&gt; [1] 1434
#&gt; 
#&gt; </div><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## You can also collapsed the raw data</span>
<span class='no'>collapsedFullRaw</span> <span class='kw'>&lt;-</span> <span class='fu'>collapseFullCoverage</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>genomeDataRaw</span>), <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Leonardo Collado-Torres, Andrew E. Jaffe, Jeffrey T. Leek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


